<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>MathJax example</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async
          src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>

  <script src="custom_scripts.js"></script>

  <link rel="stylesheet" href="custom_style.css">
</head>
<body>
  \(\newcommand\mymat[1]{\begin{bmatrix*}[r]#1\end{bmatrix*}}\)
  \(\newcommand\mysys[1]{\begin{aligned}#1\end{aligned}}\)

  <header id="site-header" class="center" height="52px">
    <label>font size: </label>
    <button id="decFontSizeButton" onclick="changeFontSize(this)">-</button>
    <button id="incFontSizeButton" onclick="changeFontSize(this)">+</button>
    <span>&nbsp</span>

    <label>margin size: </label>
    <button id="decMarginButton" onclick="changeMargin(this)">-</button>
    <button id="incMarginButton" onclick="changeMargin(this)">+</button>
    <span>&nbsp</span>

    <label>go to: </label>
    <button onclick="gotoTop()">top</button>
    <button onclick="gotoBottom()">bottom</button>
    <span>&nbsp</span>

    <label for="bg-color">bg color: </label>
    <select name="bg-color" id="bg-color" onchange="changeBGColor()">
      <option value="rgba(245, 233, 222, 0.651)" selected>light brown</option>
      <option value="rgba(245, 245, 245)">light grey</option>
      <option value="rgba(255, 255, 255)">white</option>
    </select>
    <span>&nbsp</span>

    <label>dark mode: </label>
    <label class="switch">
      <input type="checkbox">
      <span class="slider round"></span>
    </label>

  </header>

  <main id="main-content">
    <h1>Factorization into \(A=LU\)</h1>
    <p>
      One goal of today's lecture is to understand Gaussian elimination in terms of matrices; 
      to find a matrix \(L\) such that \(A=LU\). We start with some useful facts about 
      matrix multiplication.
    </p>

    <h2>Inverse of a product</h2>
    <p>
      The inverse of a matrix product \(AB\) is \((AB)^{-1}=B^{-1}A^{-1}\).
    </p>

    <h2>Transpose of a product</h2>
    <p>
      We obtain the <i>transpose</i> of a matrix by exchanging its rows and columns. 
      In other words, the entry in row \(i\) column \(j\) of \(A\) is the entry in row \(j\) 
      column \(i\) of \(A^T\).
      \[A_{ij} \rightarrow A^{T}_{ji}\]
    </p>

    <h2>LU decomposition</h2>
    <p>
      We've seen how to use elimination to convert a suitable matrix \(A\) into an 
      upper triangular matrix \(U\). This leads to the factorization \(A=LU\), 
      which is very helpful in understanding the matrix \(A\).
    </p>
    <p>
      Recall that (when there are no row exchanges) we can describe the elimination of the 
      entries of matrix \(A\) in terms of multiplication by a succession of elimination 
      matrices \(E_{ij}\), so that:
      \[
        A \rightarrow E_{21}A \rightarrow E_{31}E_{21}A \rightarrow \cdots \rightarrow U
      \]
      In the two by two case, this looks like:
      \[
        \mysys{
          \mymat{1&0\\-4&1}\mymat{2&1\\8&7} &= \mymat{2&1\\0&3}\\
          E_{21}A &= U
        }
      \]
      We can convert this to a factorization \(A=LU\) by "canceling" the matrix \(E_{21}\); 
      multiply by its inverse to get \(E^{-1}_{21}E_{21}A = E^{-1}_{21}U\).
      \[
        \mysys{
          \mymat{2&1\\8&7} &= \mymat{1&0\\4&1}\mymat{2&1\\0&3}\\
          A &= LU
        }
      \]
      The matrix \(U\) is upper triangular with pivots on the diagonal. 
      The matrix \(L\) is <span class="nowrapi">lower triangular</span> and 
      has ones on the diagonal. Sometimes we will also want to factor out a diagonal matrix 
      whose entries are the pivots:
      \[
        \mysys{
          \mymat{2&1\\8&7} &= \mymat{1&0\\4&1}\mymat{2&0\\0&3}\mymat{1&1/2\\0&1}\\
          A &= LDU^{'}
        }
      \]
    </p>
    <p>
      In the three dimensional case, if \(E_{32}E_{31}E_{21}A=U\), 
      then \(A = E_{21}^{-1}E_{31}^{-1}E_{32}^{-1}A= LU\).<br>
      For example, suppose \(E_{31}\) is the identity matrix (for simplicity sake):
      \[
        \mysys{
          \mymat{1&0&0\\0&1&0\\0&\color{red}-5&1}\mymat{1&0&0\\\color{blue}-2&1&0\\0&0&1}
          &= \mymat{1&0&0\\\color{blue}-2&1&0\\\color{purple}10&\color{red}-5&1} \\
          E_{32}E_{21} &= E
        }
      \]
      The <span style="color:purple;font-weight:bold">10</span> in the lower left corner arises because we subtracted twice the first row 
      from the second row, then subtracted five times the new second row from the third.
    </p>
    <p>
      The factorization \(A=LU\) is preferable to the statement \(EA=U\) because 
      the combination of row subtractions does not have the effect on \(L\) that 
      it did on \(E\). Here \(L=E^{-1}=E_{21}^{-1}E_{32}^{-1}\):
      \[
        \mysys{
          \mymat{1&0&0\\2&1&0\\0&0&1}\mymat{1&0&0\\0&1&0\\0&5&1}
          &= \mymat{1&0&0\\2&1&0\\\color{purple}0&5&1} \\
          E_{21}^{-1}E_{32}^{-1} &= L
        }
      \]
      Notice the <span style="color:purple;font-weight:bold">0</span> in 
      row three column one of \(L=E^{-1}\), where \(E\) has a 10. 
      If there are no row exchanges, the multipliers from the elimination matrices are 
      copied directly into \(L\).
    </p>
    <h2>How expensive is elimination?</h2>
    <p>
      Some applications require inverting very large matrices. This is done using a computer, 
      of course. How hard will the computers have to work? How long will it take?
    </p>
    <p>
      When using elimination to find the factorization \(A=LU\), we just saw that we can build 
      \(L\) as we go by keeping tack of row subtractions. We have to remember \(L\) and 
      (the matrix which will become) \(U\); we don't have to store \(A\) or \(E_{ij}\) in 
      the computer's memory.
    </p>
    <p>
      How many operations does the computer perform during the elimination process of an 
      \(n \times n\) matrix? A typical operation is to multiply one row and then subtract it 
      from another, which requires on the order of \(n\) operations. 
      There are \(n\) rows, so the total number of operations used in eliminating entries 
      in the first column is about \(n^2\). The second row and column are shorter; 
      that product costs about \((n-1)^2\) operations, and so on. The total number of 
      operations needed to factor \(A\) into \(LU\) is on the order of \(n^3\):
      \[
        1^2 + 2^2 + \cdots + (n+1)^2 + n^2 = SHITFUCK
      \]
    </p>

  </main>

  <footer>
    <hr>
    <select onchange="location = this.value">
      <option value="lecture_note_0.html">Overview</option>
      <option value="lecture_note_1.html">Lecture 1</option>
      <option value="lecture_note_2.html">Lecture 2</option>
      <option value="lecture_note_3.html">Lecture 3</option>
      <option value="lecture_note_4.html" selected>Lecture 4</option>
    </select>
  </footer>

</body>
</html>